<!--"section-export.html" 16.09.2025 -->

    <section id="export-bereich" class="module" data-original-index="3">
      <div class="module-header"> 
        <h2>Export</h2>
      </div>

      <div class="module-content">

<!------PDF - Tagesrapport -->
        <div class="button-container">
          <button class="tagesrapport-button" onclick="openTagesrapportOverlay()">Tagesrapport</button>
        </div>

<!------PDF - Tabelle Anmeldung -->
        <div class="button-container">
          <button class="pdf-export-button" onclick="togglePdfExport('Anmeldung', this)">PDF - Tabelle Anmeldung ►</button>
          <div class="loader" style="display: none;"></div>
        </div>
        <div class="button-container">
          <div id="pdfExportInfo_Anmeldung" class="export-info-area" style="display: none; margin-top: 0px; margin-bottom: 0px; font-size: 0.9em;">
            <p id="emailStatus_Anmeldung"></p>
            <p id="downloadLink_Anmeldung"></p>
          </div>
        </div>

<!------PDF - Tabelle Mitarbeiter -->
        <div class="button-container">
          <button class="pdf-export-button" onclick="togglePdfExport('Mitarbeiter', this)">PDF - Tabelle Mitarbeiter ►</button>
          <div class="loader" style="display: none;"></div>
        </div>
        <div class="button-container">
          <div id="pdfExportInfo_Mitarbeiter" class="export-info-area" style="display: none; margin-top: 0px; margin-bottom: 0px; font-size: 0.9em;">
            <p id="emailStatus_Mitarbeiter"></p>
            <p id="downloadLink_Mitarbeiter"></p>
          </div>
        </div>

<!------XLSExport -->
        <div class="button-container">
          <button onclick="XLSExport(this)">XLS-Export "Tafel Sterkrade"</button>
          <div class="loader" style="display: none;"></div>
        </div>
      </div>
    </section>

 
<!------Overlay Rapport -->
<div id="overlayRapport">
  <div id="overlayRapport-content">
    <h2 id="overlayRapport-title">Export/Tagesrapport</h2>

    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; font-size: 0.9em;">
      <div style="display: flex; align-items: center; gap: 5px">
        <button onclick="zeigeVorherigenTagesrapportTermin()">&#9668;</button>
        <select id="tagesrapportTerminAuswahl" style="flex: 1"></select>
        <button onclick="zeigeNaechstenTagesrapportTermin()">&#9658;</button>
      </div>
    </div>
    
    <p id="TagesrapportInfo" style="margin-bottom: 10px; font-size: 0.9em;"></p>

    <div class="scrollbox scrollbox-anmeldungen">
      <table id="scrollboxAnmeldungen-table"></table>
    </div>

    <div class="overlayRapport-buttons">
      <button onclick="closeOverlayRapport()">Schließen</button>
      <button onclick="createRapportAndExport('pdf')">PDF-Datei</button>
      <button onclick="createRapportAndExport('xlsx')">XLSX-Datei</button> 
    </div>

    <div id="rapportStatusContainer" class="export-status-container">
      <p id="rapportStatusText"></p>
      <div id="rapportSpinner" class="spinner small hidden"></div>
    </div>

  </div>
</div>
